<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Rap Roulette | <%= title %></title>
  <link rel="stylesheet" type="text/css" href="/stylesheets/reset.css" />
  <link rel="stylesheet" type="text/css" href="/stylesheets/text.css" />
  <link rel="stylesheet" type="text/css" href="/stylesheets/960.css" />
  <link rel="stylesheet" type="text/css" href="/stylesheets/raproulette.css" />
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
  <script src="/scripts/jquery-animate-css-rotate-scale.js"></script>
  <script src="/scripts/jquery-css-transform.js"></script>
  <script src="/scripts/rotate3Di.js"></script>
  <script src="/scripts/animation.js"></script>
  <script src="/scripts/soundmanager2-jsmin.js" type="text/javascript"></script>
  <script src="http://staging.tokbox.com/v0.91/js/TB.min.js"></script>
  <script src="/socket.io/socket.io.js" type="text/javascript"></script>
  <script src="/scripts/events.js" type="text/javascript"></script>
  <script src="/scripts/soundboard.js" type="text/javascript"></script>
  <script src="/scripts/model.js" type="text/javascript"></script>
  <script src="/scripts/jquery.simplemodal.1.4.2.min.js" type="text/javascript"></script>
  <script type="text/javascript">

    // globals set from the server
    var game_debug = <%= GLOBAL.game_debug %>;
    var room_id = "<%- room.id %>";
    
    // page init
    $(document).ready(function() {
    
        initModel(function (model) {
            
            model.player = new model.Player({sid: "<%= sid %>"}, function (player) { 
                //alert(player.sid);
                gSock.emit("room.enter", { sid: player.sid, room_id: room_id });
            });
            
            model.room = new model.Room(<%- JSON.stringify(room) %>, function (room) {
              //alert(room.battle_id);
            });
            
            <% if (typeof battleState !== 'undefined') { %>
            model.battle = new model.Battle(<%- JSON.stringify(battleState) %>, function (battle) {
              //alert(battle.song_id);
              
              $("div.video-wrapper0").find("span").replaceWith('<span>' + battle.players[0] + '</span>');
              $("div.video-wrapper1").find("span").replaceWith('<span>' + battle.players[1] + '</span>');
            
            });
            <% } %>
             
        });

        initEvents(function () {});
        
        initSound({ beat_volume: 5, effects_volume: 50 }, function (soundManager) {});
        
        initServerClock(<%= ( new Date().getTime() + 700) %>);
        initOPENTOK(function () {});
        populateRoom();
        updateGraph();
        crowdAction('calm');
    });

  </script>
  <script src="/scripts/opentok.js"></script>
</head>
<body>
  <!---<div class="spotlight-wrapper">
    <img class="spotlight" src="images/spotlight.png" />
  </div>--->
  <div id="navbar-wrapper">
    <div id="navbar">
      <a href="/"><img src="images/logo.png" /></a>
      <div id="logout">
      <!--<a href="#logout">
        <img src="http://dummyimage.com/25x25" />
        Raj Vir
      </a>--->
      </div>
    </div>
  </div>

  <div class="container_12">

    
	<span id="soundplayer"></span>
    
    <div class="subwoofer"></div>
    <div class="stage">
    <div class="lights">
    </div>
    <div class="videoswrapper">
      <div class="winner rapper">
        <div class="video-wrapper video-wrapper0">
          <div class="video video0">
            <div id="pub0"></div>
          </div>
          <span>&nbsp;</span>
          <button class="madprops left" rel='0'>Mad Props!</button>
        </div>
        <div class="clear"></div>
      </div>
      
      
        <div class="dashboard">
        <div class="songinfo">Lemonade
  	      <br>Gucci Mane
  	      <br><a href="http://itunes.com">Buy on iTunes</a>
        </div>
        <div class="vs"></div>
        <div id="timer" class="timer">:00</div>
        </div>

       <div class="challenger rapper">
        <div class="video-wrapper video-wrapper1">
          <div class="video video1">
            <div id="pub1"></div>
          </div>
          <span>&nbsp;</span>
          <button class="madprops right" rel='1'>Mad Props!</button>
        </div>
        <div class="clear"></div>
    </div>
      </div>
      <div class="gauge">
        <div class="meter"></div>
      </div>
      <div class="bar left"></div>
      <div class="bar right"></div>
      <div class="clear"></div>
      <div class="speaker left"></div>
      <div class="speaker right"></div>

    </div>
	
	<div id="enqueue-popup">
	<p>YOU UP
		GET READY TO SPIT
		</p>
		
</div>
	
    <div class="clear"></div>
    <div class="crowd">
    <button class="getinline">Get in Line</button>
    <ul class="queue" id="queue">
        <h4 id="queue_lineup">Lineup</h4>
      </ul>
    </div>
  </div>  
</body>
</html>
